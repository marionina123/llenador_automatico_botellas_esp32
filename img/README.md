stateDiagram-v2
    [*] --> SISTEMA_DETENIDO

    SISTEMA_DETENIDO --> ESPERANDO_BOTELLA: START
    SISTEMA_DETENIDO --> SISTEMA_DETENIDO: STOP

    ESPERANDO_BOTELLA --> BOTELLA_DETECTADA: botellaEstable
    ESPERANDO_BOTELLA --> ESPERANDO_BOTELLA: sinBotella
    ESPERANDO_BOTELLA --> SISTEMA_DETENIDO: STOP

    BOTELLA_DETECTADA --> ESPERANDO_BOTELLA: botellaRetirada
    BOTELLA_DETECTADA --> LLENANDO: modoAuto / botellaEstable
    BOTELLA_DETECTADA --> LLENANDO: modoManual / LLENAR
    BOTELLA_DETECTADA --> SISTEMA_DETENIDO: STOP

    LLENANDO --> LLENADO_COMPLETADO: volumenObjetivoAlcanzado
    LLENANDO --> ERROR_SISTEMA: botellaRetirada
    LLENANDO --> ERROR_SISTEMA: sinFlujo
    LLENANDO --> ERROR_SISTEMA: timeoutLlenado
    LLENANDO --> SISTEMA_DETENIDO: STOP

    LLENADO_COMPLETADO --> ESPERANDO_BOTELLA: botellaRetirada
    LLENADO_COMPLETADO --> SISTEMA_DETENIDO: STOP

    ERROR_SISTEMA --> ESPERANDO_BOTELLA: START (rearmar)
    ERROR_SISTEMA --> SISTEMA_DETENIDO: STOP
